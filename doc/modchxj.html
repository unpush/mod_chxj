<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/REC-html401/loose.dtd">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="generator" content="SmartDoc 1.1">
<meta name="author" content="Atsushi Konno" lang="ja">
<meta name="date" content="Last modified: Sat, 23 Mar 2008 03:21:16 +0900" lang="ja">
<title>mod_chxj</title>
<style type="text/css">
<!--
/*
    article.css

    since   : Nov. 21, 1998
    version : Aug. 21, 2003
    author  : ASAMI, Tomoharu (asami@XMLSmartDoc.org)
*/

A:link {
  color: green;
}

A:visited {
  color: black;
}

A:hover{
  color: gold;
};

body {
  background: white;
  font-family: times, serif;
}

h1 {
}

h1.title {
  color: black;
  background: gold;
  text-align: center;
  border-style: outset;
  border-color: yellow;
  padding: 10pt;
  margin-left: 60pt;
  margin-right: 60pt;
}

h1.part {
  font-weight: bold;
  color: black;
  background: gold;
  padding: 20pt;
}

h1.chapter {
  color: tan;
  background: black;
  text-align: left;
  padding: 5pt;
}

h2 {
  color: bisque;
  background: #666666;
  padding: 3pt;
}

h3 {
  color: black;
  background: #aaaaaa;
  padding: 2pt;
  margin-right: 100pt;
}

h4 {
  color: black;
  background: #eeeeee;
  padding: 1pt;
  margin-right: 200pt;
}

dfn {
  font-weight: bold;
  font-style: normal;
}

code {
  font-family: helvetica, sans-serif;
  font-weight: bold;
}

li p {
  text-indent: 0pt;
}

dt {
  font-weight: bold;
}

th p {
  text-indent: 0pt;
}

td p {
  text-indent: 0pt;
}

div.table {
  text-align: center;
}

table.data {
  border-collapse: separate;
  text-align: justify;
  margin-left: auto;
  margin-right: auto;
  margin-top: 10pt;
  margin-bottom: 10pt;
  background-color: green;
}

table.data caption {
  background-color: khaki;
  font-weight: bold;
}

table.data th {
  color: yellow;
  background-color: lightseagreen;
}

table.data td {
  background-color: antiquewhite;
}

table.data td.key {
  background-color: salmon;
  font-weight: bold;
}


table.menu {
  text-align: justify;
  margin-left: auto;
  margin-right: auto;
  margin-top: 10pt;
  margin-bottom: 10pt;
  text-align: center;
}

table.menu caption {
  background-color: khaki;
  font-weight: bold;
}

table.menu th {
  color: yellow;
  background-color: lightseagreen;
}

table.menu td {
  color: Maroon;
  background-color: antiquewhite;
  font-weight: bold;
  padding: 10pt;
}

table.menu td.key {
  font-size: x-large;
  color: RoyalBlue;
  background-color: LightGreen;
  font-weight: bold;
  padding: 10pt;
}

table.menu td.key A:link {
  color: RoyalBlue;
}

table.menu td.key A:visited {
  color: RoyalBlue;
}

table.navigator {
  text-align: justify;
  margin-left: auto;
  margin-right: auto;
}

table.navigator td {
  text-align: center;
  font-weight: bold;
}

table.languages {
  text-align: justify;
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 0pt;
  margin-top: 0pt;
  font-size: x-small;
  position: absolute;
  right: 0pt;
}

table.languages td.current {
}

table.languages td.other {
  background-color: Orange;
}

p {
  margin: 0pt;
  text-indent: 1em;
}

p.ja {
  margin: 0pt;
  text-indent: 1em;
}

p.first {
  margin: 0pt;
  text-indent: 0em;
}

p.first_ja {
  margin: 0pt;
  text-indent: 1em;
}

div.title {
  text-align: center;
}

span.title {
  font-size: larger;
}

span.subtitle {
  font-size: smaller;
}

div.toc {
  background-color: cornsilk;
  padding: 10pt;
  border-style: inset;
  border-color: cornsilk;
  margin-top: 10pt;
  margin-bottom: 30pt;
}

div.titletoc {
  background-color: cornsilk;
  padding: 10pt;
  border-style: inset;
  border-color: cornsilk;
  margin-top: 10pt;
  margin-bottom: 30pt;
}

div.date {
  text-align: center;
}

div.org {
  text-align: center;
}

div.author {
  text-align: center;
  font-weight: bold;
}

div.email {
  text-align: center;
}

div.hp {
  text-align: center;
}

div.summary {
  color: maroon;
  background: darkkhaki;
  border-style: inset;
  border-color: khaki;
  margin-top: 20pt;
  margin-bottom: 20pt;
  margin-left: 30pt;
  margin-right: 30pt;
  padding: 5pt;
}

div.comment {
  color: red;
  background: yellow;
}

span.comment {
  color: red;
  background: yellow;
}

div.navigator {
  background: khaki;
  border-top: 1pt solid black;
  border-bottom: 1pt solid black;
  text-align: center;
  margin-top: 10pt;
  margin-bottom: 10pt;
}

div.navigatortop {
  background: khaki;
  border-top: 1pt solid black;
  border-bottom: 1pt solid black;
  text-align: center;
  margin-bottom: 10pt;
}

div.navigatorbottom {
  background: khaki;
  border-top: 1pt solid black;
  border-bottom: 1pt solid black;
  text-align: center;
  margin-top: 10pt;
}

div.languages {
  text-align: right;
}

div.footnote {
  background: antiquewhite;
}

div.fyi {
  color: maroon;
  background: peachpuff;
  padding: 5pt;
  margin-top: 10pt;
  margin-bottom: 10pt;
}

div.fyi div.title {
  background: antiquewhite;
  font-weight: bold;
  padding: 5pt;
  margin-top: 5pt;
  margin-bottom: 5pt;
}

div.caption {
  background: lavender;
  font-weight: bold;
  padding: 5pd;
  width: 300pt;
  margin-top: 10pt;
}

div.result {
  background: ivory;
  border-style: inset;
  border-color: gold;
  padding: 10pt;
  margin-top: 10pt;
  margin-bottom: 10pt;
}

span.caption {
  background: lavender;
  font-weight: bold;
}

pre.program {
  background-color: gainsboro;
  font-family: courier, monospace;
  padding: 5pt;
  margin-right: 30pt;
}

pre.program em {
  color: red;
  font-style: normal;
}

pre.program strong {
  color: red;
  background-color: yellow;
  font-style: normal;
}

pre.program span.keyword {
  color: Blue;
  font-style: normal;
}

pre.program span.primitive {
  color: Green;
  font-style: normal;
}

pre.program span.comment {
  color: Red;
  background-color: gainsboro;
  font-style: normal;
}

pre.program span.quote {
  color: OrangeRed;
  font-style: normal;
}


pre.program span.class {
  color: darkcyan;
  font-style: normal;
}

pre.program span.constant {
  color: blueviolet;
  font-style: normal;
}

pre.program span.variable {
  color: DarkGoldenrod;
  font-style: normal;
}

var {
  color: green;
  font-style: italic;
}

tt {
  font-family: courier, monospace;
}

code {
  font-family: helvetica, sans-serif;
  font-weight: bold;
}

pre.console {
  background-color: black;
  color: white;
  font-family: courier, monospace;
  padding: 5pt;
  margin-right: 30pt;
}

pre.console kbd {
  font-family: courier, monospace;
  color: yellow;
}

span.toggle {
  font-weight: bold;
}

div.figure {
  text-align: center;
}

img.figure {
  margin: 10pt;
}

div.equation {
  margin-top: 1em;
  margin-right: 30pt;
  margin-bottom: 1em;
  padding-top: 1em;
  padding-left: 4em;
  padding-bottom: 1em;
  background: powderblue;
}

div.equation table {
}

div.equation table td.padding {
  width:2em
}

td.equationNumber {
  width: 4em;
  text-align: right;
}
-->
</style>
<script type="text/javascript">
<!--
/*
 * HTML4JavaScript.js
 *
 * @since   Nov. 17, 1998
 * @version Feb. 18, 2002
 * @author  ASAMI, Tomoharu (asami@XMLSmartDoc.org)
 */
var backupColor=null;
var backupBGColor=null;
var backupFontStyle=null;
var backupIDColor=null;
var backupIDBGColor=null;
var backupIDFontStyle=null;
var backupIDBorderStyle=null;

var backupOnKeyDown=null;

function normal(element) {
  if (document.all) {
    if (backupColor != null) {
      element.style.color=backupColor;
      backupColor=null;
    }
    if (backupBGColor != null) {
      element.style.background=backupBGColor;
      backupBGColor=null;
    }
    if (backupFontStyle != null) {
      element.style.fontStyle=backupFontStyle;
      backupFontStyle=null;
    }
    var id = null;
    if (element.href != null) {
      id = element.href;
      id = id.substring(id.indexOf("#") + 1);
    }
    if (id != null) {
      var target = document.all.item(id, 0);
      if (backupIDColor != null) {
        target.style.color=backupIDColor;
        backupIDColor=null;
      }
      if (backupIDBGColor != null) {
        target.style.background=backupIDBGColor;
        backupIDBGColor=null;
      }
      if (backupIDFontStyle != null) {
        target.style.fontStyle=backupIDFontStyle;
        backupIDFontStyle=null;
      }
      if (backupIDBorderStyle != null) {
        target.style.borderStyle=backupIDBorderStyle;
        backupIDBorderStyle=null;
      }
    }
  }
}

function hilight(element) {
  if (document.all) {
    backupBGColor=element.style.background;
    element.style.background="gold";
  }
}

function hilightString(element, color) {
  if (color == null) {
    color="darkolivegreen";
  }
  if (document.all) {
    backupColor=element.style.color;
    backupFontStyle=element.style.fontStyle;
    element.style.color=color;
  }
}

function hilightSelflink(element, color) {
  if (color == null) {
    color="darkolivegreen";
  }
  if (document.all) {
    backupColor=element.style.color;
    backupBGColor=element.style.background;
    backupFontStyle=element.style.fontStyle;
    element.style.color=color;
    var id = null;
    if (element.href != null) {
      id = element.href;
      id = id.substring(id.indexOf("#") + 1);
    }
    if (id != null) {
      var target = document.all.item(id, 0);
      backupIDColor=target.style.color;
//      backupIDBGColor=target.style.background;
//      backupIDFontStyle=target.style.fontStyle;
      backupIDBorderStyle=target.style.borderStyle;
      target.style.color="red";
      target.style.borderStyle="outset";
    }
  }
}

function hilightHyperlink(element, color) {
  if (color == null) {
    color="darkorange";
  }
  if (document.all) {
    backupColor=element.style.color;
    backupBGColor=element.style.background;
    backupFontStyle=element.style.fontStyle;
    element.style.color=color;
  }
}

function hilightExternallink(element, color) {
  if (color == null) {
    color="purple";
  }
  if (document.all) {
    backupColor=element.style.color;
    backupBGColor=element.style.background;
    backupFontStyle=element.style.fontStyle;
    element.style.color=color;
  }
}

function toggleChildren(node) {
  if (document.all) {
    for (i = 0;i < node.children.length;i++) {
      var child = node.children[i];
      if (child.className == "dynamic") {
        if (child.style.display == "") {
            child.style.display = "none";
        } else {
            child.style.display = "";
        }
      }
    }
  }
}

function toggleDynamic(node) {
  if (document.all) {
    if (node.tagName == "LI") {
      toggleChildren(node);
    }
  }
}

function isMsie4orGreater() { 
  var ua = window.navigator.userAgent; var msie = ua.indexOf ("MSIE");
  if (msie > 0) {
    return (parseInt (ua.substring (msie+5, ua.indexOf (".", msie))) >= 4)   
      && (ua.indexOf ("MSIE 4.0b") <0);
  } else {
    return false;
  }
}

function keyEventHandler() {
  if (document.all) {
    if (event.keyCode == 13) {
      var child = document.all.item("doc_next_page_", 0);
      if (child != null) {
        location.href = child.href;
      }
    } else if (event.keyCode == 39) {
      var child = document.all.item("doc_next_page_", 0);
      if (child != null) {
        location.href = child.href;
      }
    } else if (event.keyCode = 37) {
      var child = document.all.item("doc_prev_page_", 0);
      if (child != null) {
        location.href = child.href;
      }
    } else {
      backupOnKeyDown();
    }
  }
}

function setOHPHandler() {
  backupOnKeyDown=document.onkeydown;
  document.onkeydown=keyEventHandler;
}
// -->
</script>
</head>
<body>
<div style="text-align:right"><a href="http://www.XMLSmartDoc.org" target="_top"><span style="color:#4F5952;background:#EE8362;font-family:sans-serif;font-size:xx-small;text-decoration:none">Powered by </span><span style="color:#058258;background:#EE8362;font-family:fantasy, sans-serif;font-size:x-small;text-decoration:none">SmartDoc</span></a></div>

<h1 class="title">mod_chxj<br><span class="subtitle"></span></h1>

<div class="date">Last modified: Sat, 23 Mar 2008 03:21:16 +0900</div>
<div class="author">Atsushi Konno</div>
<h2>目次</h2>

<div class="toc">
<ul>
<li> <a href="#doc1_17" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Overview</a>
<li> <a href="#doc1_20" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">インストール</a>
<ul>
<li> <a href="#doc1_22" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">準備</a>
<li> <a href="#doc1_46" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">mod_chxjの入手</a>
<li> <a href="#doc1_52" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">インストール</a>
</ul>
<li> <a href="#doc1_104" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Build</a>
<ul>
<li> <a href="#doc1_106" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">メイン</a>
<ul>
<li> <a href="#doc1_108" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">--with-apache-header</a>
<li> <a href="#doc1_114" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">--with-apxs</a>
<li> <a href="#doc1_120" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">--with-apr-config</a>
<li> <a href="#doc1_126" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">--with-apu-config</a>
</ul>
<li> <a href="#doc1_133" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Cookieシミュレート機能でMySQLを使用する場合</a>
<ul>
<li> <a href="#doc1_135" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">--enable-mysql-cookie</a>
<li> <a href="#doc1_141" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">--with-mysql-header</a>
<li> <a href="#doc1_147" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">--with-mysql-lib-dir</a>
</ul>
</ul>
<li> <a href="#doc1_155" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Configuration</a>
<ul>
<li> <a href="#doc1_157" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">htmlファイルが変換対象の場合</a>
<li> <a href="#doc1_172" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">php等の出力結果が変換対象の場合</a>
<li> <a href="#doc1_187" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">xoopsを使用し、且つwordpress、bwikiを使用している場合</a>
<li> <a href="#doc1_202" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">画像自動変換機能を使用する場合</a>
<li> <a href="#doc1_279" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">文字コードを変換したい場合</a>
<li> <a href="#doc1_323" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">ディレクティブ</a>
</ul>
<li> <a href="#doc1_448" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">対応するCHTMLタグ</a>
<li> <a href="#doc1_1231" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">独自拡張タグ</a>
<li> <a href="#doc1_1268" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">文字コードについて</a>
<li> <a href="#doc1_1297" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">絵文字について</a>
<ul>
<li> <a href="#doc1_1302" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">絵文字変換定義</a>
<ul>
<li> <a href="#doc1_1309" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">DoCoMo→DoCoMo/au/SoftBank変換定義</a>
<li> <a href="#doc1_1356" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">au→DoCoMo変換定義</a>
<li> <a href="#doc1_1399" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">SoftBank→DoCoMo変換定義</a>
</ul>
</ul>
<li> <a href="#doc1_1450" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">デバイス定義 device_data.xml</a>
<ul>
<li> <a href="#doc1_1454" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">デバイス定義の要素</a>
</ul>
<li> <a href="#doc1_1864" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">イメージ画像変換機能</a>
<ul>
<li> <a href="#doc1_1873" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">サムネイルモード</a>
<li> <a href="#doc1_1879" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">壁紙モード</a>
<li> <a href="#doc1_1885" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">EzGetモード</a>
<li> <a href="#doc1_1891" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">その他の機能</a>
</ul>
<li> <a href="#doc1_1922" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">ＱＲコード出力機能</a>
<ul>
<li> <a href="#doc1_1924" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">ＱＲコード出力ハンドラの登録</a>
<li> <a href="#doc1_1930" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">ＱＲコードソースファイルの設置</a>
<li> <a href="#doc1_1954" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">ＱＲコードの動的出力機能</a>
</ul>
<li> <a href="#doc1_1961" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Cookieシミュレート機能(EXPERIMENTAL)</a>
<ul>
<li> <a href="#doc1_1963" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Cookieシミュレート機能(EXPERIMENTAL)</a>
<li> <a href="#doc1_1969" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">One-Time ID</a>
<li> <a href="#doc1_1972" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Cookieの保存場所</a>
<li> <a href="#doc1_2048" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Cookieの保持期間</a>
</ul>
<li> <a href="#doc1_2055" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Refererシミュレート機能(EXPERIMENTAL)</a>
<ul>
<li> <a href="#doc1_2057" onmouseover="hilightSelflink(this)" onmouseout="normal(this)">Refererシミュレート機能(EXPERIMENTAL)</a>
</ul>
</ul>
</div>

<h2 id="doc1_17">Overview</h2>

<p class="first_ja">mod_chxjはオープンソースの携帯向けコンテンツ変換Apache2.x用モジュールであり、CHTML（DoCoMo i-Mode用CHTML3.0)で記述された文書や通常のHTMLで記述された文書を、アクセスに来た端末のUser-Agentヘッダを見て、それぞれの端末にあった形式に変換します。HTML文書に限らず、画像（jpg、gif、png）、絵文字についても、定義ファイルに従ってそれぞれのキャリアにあった絵文字に変換します。Cookie非対応端末、Refer非対応端末のために、Set-Cookie、CookieヘッダやRefererヘッダをシミュレートすることもできます（EXPERIMENTAL)。</p>

<h2 id="doc1_20">インストール</h2>


<h3 id="doc1_22">準備</h3>

<p class="first_ja">mod_chxjをインストールする前に、下記のものを用意する必要があります。</p>

<ol>
<li> Apache2.xのヘッダーファイル群
<li> Apache2.x用のapxs
<li> apr(Apache Portable Runtime)ライブラリとそのヘッダファイル郡(apu含む)
<li> automake、autoconf、libtool1.3.X
<li> ImageMagick(MagickWand)
<li> Linux</ol>


<h3 id="doc1_46">mod_chxjの入手</h3>

<p class="first_ja">mod_chxjは<a href="http://sourceforge.jp/projects/modchxj/" target="_top" onmouseover="hilightExternallink(this)" onmouseout="normal(this)">こちら</a>からダウンロードすることができます。</p>

<h3 id="doc1_52">インストール</h3>

<p class="first_ja">以下にmod_chxjインストール手順を示します。</p>

<ol>
<li> <p>Configureスクリプトを生成します(必須ではない)</p>

<div id="doc1_58" class="caption">Configure スクリプトの生成</div>
<pre class="program" style="margin-top:0">
$ ./buildconf.sh
</pre>

<p><span class="note"><a href="#doc1_61" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="&quot;$&quot;はプロンプトをあらわします。"><sup>(1)</sup></a></span></p>
<li> <p>Configure</p>

<div id="doc1_67" class="caption">Configure</div>
<pre class="program" style="margin-top:0">
$ ./configure
</pre>

<p><span class="note"><a href="#doc1_70" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="場合によっては--with-apr-configや--with-apu-configも必要です。"><sup>(2)</sup></a></span><span class="note"><a href="#doc1_73" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="0.8.6以下の場合には--with-apache-headerが必須です"><sup>(3)</sup></a></span><span class="note"><a href="#doc1_76" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="詳細はBuildを参照"><sup>(4)</sup></a></span></p>
<li> mod_chxj.soを生成します
<div id="doc1_82" class="caption">make</div>
<pre class="program" style="margin-top:0">
$ make
</pre>
<li> apacheにインストールします
<div id="doc1_88" class="caption">install</div>
<pre class="program" style="margin-top:0">
$ make install
</pre>
<li> <p>データの設置etcディレクトリは以下のdevice_data.xmlとemoji.xmlをApacheからアクセスできるところに配置します。<span class="note"><a href="#doc1_94" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="0.9.0からemoji.xml、device_data.xmlの定義フォーマットを変更しましたのでバージョンをあわせてください"><sup>(5)</sup></a></span></p>
<p>以下、/etc/apache2/chxjディレクトリにchxj用設定ファイルを用意する場合</p>

<div id="doc1_97" class="caption">データの設置</div>
<pre class="program" style="margin-top:0">
$ mkdir -p /etc/apache2/chxj
$ cp etc/device_data.xml /etc/apache2/chxj
$ cp etc/emoji.xml /etc/apache2/chxj
</pre></ol>


<div class="footnote">
<ol>
<li id="doc1_61" value="1"> &quot;$&quot;はプロンプトをあらわします。<li id="doc1_70" value="2"> 場合によっては--with-apr-configや--with-apu-configも必要です。<li id="doc1_73" value="3"> 0.8.6以下の場合には--with-apache-headerが必須です<li id="doc1_76" value="4"> 詳細はBuildを参照<li id="doc1_94" value="5"> 0.9.0からemoji.xml、device_data.xmlの定義フォーマットを変更しましたのでバージョンをあわせてください</ol>
</div>


<h2 id="doc1_104">Build</h2>

<p class="first_ja">mod_chxjをコンパイルするにはconfigureを行う必要があります。以下にconfigureのオプションを記します。</p>

<h3 id="doc1_106">メイン</h3>


<h3 id="doc1_108">--with-apache-header</h3>

<p class="first_ja">通常指定する必要はありません。configureでApacheのヘッダファイルの場所が検知できなかった場合や、任意のApacheヘッダファイルを使用したい場合に指定します。</p>

<div id="doc1_110" class="caption">--with-apache-header</div>
<pre class="program" style="margin-top:0">
         $ ./configure --with-apache-header=/usr/include/apache2
      
</pre>

<p>上記は/usr/include/apache2以下にApacheのヘッダファイルがある場合の例です。</p>

<h3 id="doc1_114">--with-apxs</h3>

<p class="first_ja">通常指定する必要はありません。configureでapxsを検知できなかった場合や、任意のapxsプログラムを指定したい場合に指定します。</p>

<div id="doc1_116" class="caption">--with-apxs</div>
<pre class="program" style="margin-top:0">
         $ ./configure --with-apxs=/usr/local/apache2/bin/apxs2
      
</pre>

<p>上記は/usr/local/apache2/bin/apxs2を使用するようにapxsに指定しています。</p>

<h3 id="doc1_120">--with-apr-config</h3>

<p class="first_ja">通常指定する必要はありません。configureでapr-configを検知できなかった場合や、任意のapr-configプログラムを指定したい場合に指定します。</p>

<div id="doc1_122" class="caption">--with-apr-config</div>
<pre class="program" style="margin-top:0">
$ ./configure --with-apr-config=/usr/local/apache2/bin/apr-1-config
      
</pre>

<p>上記は/usr/local/apache2/bin/apr-1-configを使用するように指定しています。</p>

<h3 id="doc1_126">--with-apu-config</h3>

<p class="first_ja">通常指定する必要はありません。configureでapu-configを検知できなかった場合や、任意のapu-configプログラムを指定したい場合に指定します。</p>

<div id="doc1_128" class="caption">--with-apu-config</div>
<pre class="program" style="margin-top:0">
$ ./configure --with-apu-config=/usr/local/apache2/bin/apu-1-config
      
</pre>

<p>上記は/usr/local/apache2/bin/apu-1-configを使用するように指定しています。</p>

<h3 id="doc1_133">Cookieシミュレート機能でMySQLを使用する場合</h3>


<h3 id="doc1_135">--enable-mysql-cookie</h3>

<p class="first_ja">Cookieシミュレート機能を使用する際、保存先をデフォルトのDBMでは無く、MySQLに保存するようにします。DefaultのDBMで良い場合や、Cookieシミュレート機能を使用しない場合は指定する必要はありません。別途MySQLサーバを用意する必要があります。また、本オプションを指定した場合は、--with-mysql-header、--with-mysql-lib-dirも指定します。これはMySQLのヘッダとライブラリが必要なことを意味します。使用するMySQLのライブラリは今のところlibmysqlclient_r.soのみです。</p>

<div id="doc1_137" class="caption">--enable-mysql-cookie</div>
<pre class="program" style="margin-top:0">
$ ./configure --enable-mysql-cookie --with-mysql-header=/usr/include/mysql \
    --with-mysql-lib-dir=/usr/lib
      
</pre>

<p>上記は、/usr/include/mysql以下にmysql用のヘッダがあり、/usr/lib以下にlibmysqlclient_r.soがある場合の例です。</p>

<h3 id="doc1_141">--with-mysql-header</h3>

<p class="first_ja">--enable-mysql-cookieを指定した場合は必須です。MySQLのヘッダファイルの場所を指定します。</p>

<div id="doc1_143" class="caption">--with-mysql-header</div>
<pre class="program" style="margin-top:0">
$ ./configure --enable-mysql-cookie --with-mysql-header=/usr/include/mysql \
    --with-mysql-lib-dir=/usr/lib
      
</pre>


<h3 id="doc1_147">--with-mysql-lib-dir</h3>

<p class="first_ja">--enable-mysql-cookieを指定した場合は必須です。MySQLのライブラリ、libmysqlclient_r.soの設置されているディレクトリを指定します。</p>

<div id="doc1_149" class="caption">--with-mysql-lib-dir</div>
<pre class="program" style="margin-top:0">
$ ./configure --enable-mysql-cookie --with-mysql-header=/usr/include/mysql \
    --with-mysql-lib-dir=/usr/lib
      
</pre>


<h2 id="doc1_155">Configuration</h2>

<p class="first_ja">以下はmod_chxjが/usr/lib/apache2/modulesディレクトリ配下に設置されたものとしています</p>

<h3 id="doc1_157">htmlファイルが変換対象の場合</h3>

<p class="first_ja">例として、Locationが&quot;/chxj&quot;以下のものは全て変換する場合を説明します。</p>

<ol>
<li> httpd.confに以下を追加します。
<div id="doc1_163" class="caption">httpd.conf</div>
<pre class="program" style="margin-top:0">
#====================================================================================
# モジュールをApache2.0にロード
#====================================================================================
LoadModule chxj_module /usr/lib/apache2/modules/mod_chxj.so

#====================================================================================
# デバイスデータファイルの設定
#====================================================================================
ChxjLoadDeviceData  /etc/apache2/chxj/device_data.xml

#====================================================================================
# 絵文字データファイルの設定
#====================================================================================
ChxjLoadEmojiData   /etc/apache2/chxj/emoji.xml

#====================================================================================
# 変換エンジン動作指示命令
# ChxjConvRule ==&gt; ディレクティブ
# &quot;^/chxj.+$&quot;  ==&gt; Perl互換のURIパターン
# EngineOn     ==&gt; 変換エンジンを動作させる指示
# NONE         ==&gt; サーバ側の文字コード。（NONEを指定した場合は文字コード変換しない)
#====================================================================================
ChxjConvertRule &quot;^/chxj.+$&quot; &quot;EngineOn&quot; &quot;NONE&quot;
</pre>
<li> apacheの再起動。</ol>


<h3 id="doc1_172">php等の出力結果が変換対象の場合</h3>


<ol>
<li> httpd.confに以下を追加します
<div id="doc1_178" class="caption">httpd.conf</div>
<pre class="program" style="margin-top:0">
#====================================================================================
# モジュールをApache2.xにロード
#====================================================================================
LoadModule chxj_module /usr/lib/apache2/modules/mod_chxj.so

#====================================================================================
# デバイスデータの設定
#====================================================================================
ChxjLoadDeviceData  /etc/apache2/chxj/device_data.xml

#====================================================================================
# 絵文字データの設定
#====================================================================================
ChxjLoadEmojiData   /etc/apache2/chxj/emoji.xml

#====================================================================================
# 変換エンジン動作指示命令
# ChxjConvRule ==&gt; ディレクティブ
# &quot;^/chxj.+$&quot;  ==&gt; Perl互換のURIパターン
# EngineOn     ==&gt; 変換エンジンを動作させる指示。動作させたく無い場合は&quot;EngineOff&quot;
# EUC-JP       ==&gt; サーバ側の文字コード。（NONEを指定した場合は文字コード変換しない)
#                  EUC-JPからCP932に文字コード変換します。
#====================================================================================
ChxjConvertRule &quot;^/chxj.+$&quot; &quot;EngineOn&quot; &quot;EUC-JP&quot;
</pre>
<li> apacheの再起動。</ol>


<h3 id="doc1_187">xoopsを使用し、且つwordpress、bwikiを使用している場合</h3>


<ol>
<li> httpd.confに以下を追加します
<div id="doc1_193" class="caption">httpd.conf</div>
<pre class="program" style="margin-top:0">
#====================================================================================
# モジュールをApache2.xにロード
#====================================================================================
LoadModule chxj_module /usr/lib/apache2/modules/mod_chxj.so

#====================================================================================
# デバイスデータの設定
#====================================================================================
ChxjLoadDeviceData  /etc/apache2/chxj/device_data.xml

#====================================================================================
# 絵文字データの設定
#====================================================================================
ChxjLoadEmojiData   /etc/apache2/chxj/emoji.xml

#====================================================================================
# 変換エンジン動作指示命令
#====================================================================================
#====================================================================================
# bwikiの設定をします。bwikiではどうもxoopsヘッダの文字コードとbwiki内での携帯スキン
# の文字コードが一致していないようなので、bwiki内で文字コードを変換させないように
# 修正後、以下のルールを記述します。
# 
# ChxjConvRule           ディレクティブ
# &quot;^/modules/bwiki.+$&quot;   このルールを適用したいURIパターン
# &quot;EngineOn&quot;             変換エンジンを有効にします。
# &quot;EUC-JP&quot;               出力時にEUC-JPからCP932に変換させます。
# &quot;PC&quot;                   変換元HTMLはPCサイト用HTMLです。
# &quot;DoCoMo/1.0/D501i&quot;     DoCoMo端末としてbwikiにアクセスさせます。
#
#====================================================================================
ChxjConvertRule &quot;^/modules/bwiki.+$&quot; &quot;EngineOn&quot; &quot;EUC-JP&quot; &quot;PC&quot; \
    &quot;DoCoMo/1.0/D501i&quot;

#====================================================================================
# wordpressの設定をします。
# 
# ChxjConvRule               ディレクティブ
# &quot;^/modules/wordpress.+$&quot;   このルールを適用したいURIパターン
# &quot;EngineOn&quot;                 変換エンジンを有効にします。
# &quot;NONE&quot;                     出力時に文字コード変換をさせません。
# &quot;NONE&quot;                     変換元HTMLはPCサイト用HTMLではありません。
# &quot;DoCoMo/1.0/D501i&quot;         DoCoMo端末としてwordpressにアクセスさせます。
#
#====================================================================================
ChxjConvertRule &quot;^/modules/wordpress/.*$&quot; &quot;EngineOn&quot; &quot;NONE&quot; &quot;PC&quot; \
    &quot;DoCoMo/1.0/D501i&quot;

#====================================================================================
# その他の設定をします。
# 
# ChxjConvRule               ディレクティブ
# &quot;^/.+$&quot;                    このルールを適用したいURIパターン
# &quot;EngineOn&quot;                 変換エンジンを有効にします。
# &quot;EUC-JP&quot;                   出力時にEUC-JPからCP932に文字コード変換をさせます。
#
#====================================================================================
ChxjConvertRule &quot;^/.+$&quot; &quot;EngineOn&quot; &quot;EUC-JP&quot; 


&lt;Location /&gt;
  ChxjImageEngine On
  AllowOverride All
&lt;/Location&gt;
</pre>
<li> apacheの再起動。</ol>


<h3 id="doc1_202">画像自動変換機能を使用する場合</h3>


<ol>
<li> <p>httpd.confに以下を追加します。下記は、URIが/imgで始まる全ての画像に対して動作するようmod_chxjに指示しています。</p>

<div id="doc1_208" class="caption">httpd.conf</div>
<pre class="program" style="margin-top:0">
&lt;Location /img&gt;
ChxjImageEngine On
ChxjImageCacheDir /tmp
ChxjImageCopyright &quot;A.Konno&quot;
ChxjImageCacheLimit 10485760
&lt;/Location&gt;
</pre>

<p>上記の説明を以下に示します。</p>

<ol>
<li> <p>ChxjImageEngine<br></br> mod_chxjの画像変換ハンドラを起動するよう指示しています。DefaultはOff</p>
<p><br></br> <br></br></p>
<li> <p>ChxjImageCacheDir<br></br> mod_chxj画像変換ハンドラが使用する変換後の画像をおいておくディレクトリを指定します。デフォルトは/tmp。</p>

<div id="doc1_226" class="caption">ChxjImageCacheDir</div>
<pre class="program" style="margin-top:0">
      ChxjImageCacheDir /tmp
      
</pre>

<p>mod_chxjに画像変換キャッシュとして/tmpを使用するよう指示します。<br></br><br></br></p>
<li> <p>ChxjImageCopyright<br></br> mod_chxjの画像変換ハンドラに、転送禁止設定を行うよう指示します。パラメータとして任意の文字列をとります。ChxjImageCopyrightディレクティブで指定された文字列は、それぞれのイメージのコメント部に埋め込まれます。</p>

<div id="doc1_238" class="caption">ChxjImageCopyright</div>
<pre class="program" style="margin-top:0">
      ChxjImageCopyright &quot;A.Konno&quot;
      
</pre>

<p>mod_chxjに転送禁止設定を行うよう指示しています。変換後イメージのコメント部分には、キャリア毎に以下の文字列を埋め込みます。</p>
<p><b>AU の場合</b></p>

<div id="doc1_244" class="caption">AU</div>
<pre class="program" style="margin-top:0">
       kddi_copyright=on,A.Konno
       
</pre>

<p><b>DoCoMoの場合</b></p>

<div id="doc1_250" class="caption">DoCoMo</div>
<pre class="program" style="margin-top:0">
copy=&quot;NO&quot;,A.Konno
</pre>

<p><b>SoftBank/Vodafone</b>の場合は、レスポンスヘッダに</p>

<div id="doc1_256" class="caption">SoftBank/Vodafone/J-PHONE</div>
<pre class="program" style="margin-top:0">
         x-jphone-copyright:no-transfer
       
</pre>

<p>を埋め込みます。<span class="note"><a href="#doc1_259" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="SoftBank/Vodafoneの場合は、リクエストＵＲＬの最後が.pnzか、.jpzで終わるようにダミーを付けなければなりません。"><sup>(6)</sup></a></span></p>
<li> <p>ChxjImageCacheLimit<br></br> mod_chxj画像変換ハンドラが使用する変換後の画像をおいておくディレクトリの許容量を指定します。単位はbyte。</p>

<div id="doc1_267" class="caption">ChxjImageCacheLimit</div>
<pre class="program" style="margin-top:0">
      ChxjImageCacheLimit 1024
      
</pre>

<p>mod_chxjに画像変換キャッシュ最大サイズとして1kbyteと指定。※このとき変換結果が1kbyte以上あるような場合にはINTERNAL_SERVER_ERRORを返します。十分な領域を確保するか、画像サイズを小さくしてください。<br></br><br></br></p></ol></ol>


<div class="footnote">
<ol>
<li id="doc1_259" value="6"> SoftBank/Vodafoneの場合は、リクエストＵＲＬの最後が.pnzか、.jpzで終わるようにダミーを付けなければなりません。</ol>
</div>


<h3 id="doc1_279">文字コードを変換したい場合</h3>


<ol>
<li> <p>httpd.confに以下を追加します。下記は、URIが/chxjで始まる全てのコンテンツに対して動作するようmod_chxjに指示しています。サーバ側はEUC-JPであった場合の例です。mod_chxjによってSJISに変換するように指示しています。サーバ側がShift_JISで無い場合は、Shift_JISコードの10進参照文字列表記を記述することによってShift_JISコードの絵文字2バイトコードに変換しクライアントへ返します。</p>

<div id="doc1_285" class="caption">httpd.conf</div>
<pre class="program" style="margin-top:0">
ChxjConvRule &quot;^/chxj.+$&quot; &quot;EngineOn&quot; &quot;EUC-JP&quot;
</pre>

<p>上記の説明を以下に示します。</p>

<ol>
<li> <p>ChxjConvertRule<br></br>サーバサイドの文字コードを指定します。ここに、EUC-JPと指定してあった場合は、EUC-JPからCP932に変換後、クライアントに出力されます。省略した場合はNONE</p>

<ol>
<li> 変換エンジン動作指示命令<br></br>ChxjConvertRule ==&gt;ディレクティブ<br></br>&quot;^/chxj.+$&quot; ==&gt; Perl互換のURIパターン<br></br>EngineOn ==&gt;変換エンジンを動作させる指示。動作させたく無い場合は&quot;EngineOff&quot;<br></br> EUC-JP ==&gt;サーバ側の文字コード。（NONEを指定した場合は文字コード変換しない)<br></br> <br></br> EUC-JPからCP932に文字コード変換します。(libiconvに依存します)<br></br></ol>

<p><br></br><br></br></p></ol></ol>


<h3 id="doc1_323">ディレクティブ</h3>


<ol>
<li> ChxjLoadDeviceData<br></br>デバイス定義ファイルを指定します。
<div id="doc1_331" class="caption">ex)</div>
<pre class="program" style="margin-top:0">
    ChxjLoadDeviceData /etc/apache2/device.xml
  
</pre>
<li> ChxjLoadEmojiData<br></br>絵文字変換定義ファイルを指定します。
<div id="doc1_339" class="caption">ex)</div>
<pre class="program" style="margin-top:0">
    ChxjLoadEmojiData   /etc/apache2/chxj/emoji.xml
  
</pre>
<li> ChxjImageEngine<br></br>画像変換エンジンを有効にします。パラメータとしてOnとOffを指定できます。DefaultはOffです。
<div id="doc1_347" class="caption">ex)</div>
<pre class="program" style="margin-top:0">
    ChxjImageEngine On
  
</pre>
<li> ChxjImageCacheDir<br></br>イメージの一時ファイル保存場所を指定します。
<div id="doc1_355" class="caption">ex)</div>
<pre class="program" style="margin-top:0">
    ChxjImageCacheDir   /tmp
  
</pre>
<li> ChxjImageCacheLimit<br></br>イメージの一時ファイル保存許容量を指定します。下記は1MByteの例。
<div id="doc1_363" class="caption">ex)</div>
<pre class="program" style="margin-top:0">
    ChxjImageCacheLimit   1048576
  
</pre>
<li> ChxjImageCopyright<br></br>イメージに著作権情報を付与します。
<div id="doc1_371" class="caption">ex)</div>
<pre class="program" style="margin-top:0">
    ChxjImageCopyright   &quot;chosakuken jyoho&quot;
  
</pre>
<li> ChxjConvertRule<br></br> HTML変換エンジンの適用ルールを記述します。本ディレクティブを使用し、変換エンジンのOn|Offを指定します。DefaultはOFFです。また、ルールは記述された順番に評価し、マッチするものがあれば、その時点で対象ルールを適用します。パラメータは3つ必要です。下記にパラメータを記します。
<div class="table">
<table id="doc1_379" class="data" rules="groups">
<caption>パラメータ</caption>
<colgroup span="2">
<col>
<col>
</colgroup>
<tbody>
<tr class="even">
<td>第1パラメータ</td>
<td>URIを評価するPerl互換の正規表現を指定します</td>
</tr>
<tr class="odd">
<td>第2パラメータ</td>
<td>HTML変換エンジンのOn|Offを指定します。Onの場合は&quot;EngineOn&quot;。Offの場合は&quot;EngineOff&quot;を指定します。&quot;EngineOn|EngineOff&quot;の他に&quot;CookieOn|CookieOff&quot;を指定することもできます。複数指定する場合は&quot;,&quot;で区切って指定します。</td>
</tr>
<tr class="even">
<td>第3パラメータ</td>
<td>文字コードを指定します。ここで指定した文字コードから&quot;CP932&quot;に変換します。指定できる文字コードはiconv -lコマンドによって確認することができます。変換しなくて良い場合はNONEを指定してください。</td>
</tr>
<tr class="odd">
<td>第4パラメータ</td>
<td>省略した場合は、携帯ページからの変換を意味します。PC用ページからの変換を行う場合は&quot;PC&quot;を第四パラメータに指定します。</td>
</tr>
<tr class="even">
<td>第5パラメータ</td>
<td>サーバサイドアプリケーションに渡すUser-Agentを指定します。例えば、wordpress等のようにCHTMLを出力するアプリケーションがある場合は、&quot;DoCoMo/1.0/N501i&quot;等適当なUser-Agentを指定することによって、アプリケーションにCHTMLを出力するように指示することができます。ここで指定したUser-AgentはHTML出力時には評価されません。</td>
</tr>
</tbody>
</table>
</div>


<div id="doc1_425" class="caption">ex)</div>
<pre class="program" style="margin-top:0">
    ChxjConvertRule &quot;^/chxj.+$/&quot; EngineOn EUC-JP
  
</pre>
<li> <p>ChxjCookieDir<br></br>クッキーを使用する場合に指定します。クッキーの内容を保存するディレクトリを指定します。指定しない場合は/tmpに保存されます。</p>

<div id="doc1_433" class="caption">ex)</div>
<pre class="program" style="margin-top:0">
    &lt;Location /&gt;
      ChxjCookieDir   /tmp
    &lt;/Location&gt;
  
</pre>

<p>詳細は「Cookieシミュレート機能」の項を参照ください。</p>
<li> <p>ChxjCookieTimeout<br></br>クッキーを使用する場合に指定します。クッキーの保持期間を秒単位で指定します。指定しない場合は、1800秒でクッキーデータを破棄します。</p>

<div id="doc1_441" class="caption">ex)</div>
<pre class="program" style="margin-top:0">
    &lt;Location /&gt;
      ChxjCookieTimeout 10
    &lt;/Location&gt;
  
</pre>

<p>詳細は「Cookieシミュレート機能」の項を参照ください。</p></ol>


<h2 id="doc1_448">対応するCHTMLタグ</h2>

<p class="first_ja">変換可能なＣＨＴＭＬタグは以下のとおりです。</p>

<div class="table">
<table id="doc1_450" class="data" rules="groups">
<caption>対応タグ一覧</caption>
<colgroup span="7">
<col>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr class="even">
<td>タグ</td>
<td>属性</td>
<td>CHTML</td>
<td>HDML</td>
<td>XHTML</td>
<td>JHTML</td>
<td>備考</td>
</tr>
</thead>
<tbody>
<tr class="even">
<td>&lt;HTML&gt;</td>
<td align="center"></td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">属性を指定した場合は無視します</td>
</tr>
<tr class="odd">
<td>&lt;META&gt;</td>
<td align="center">http-equiv</td>
<td align="center">△</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">CHTML1.0、HDMLでは無視します</td>
</tr>
<tr class="even">
<td></td>
<td align="center">content</td>
<td align="center">△</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">CHTML1.0、HDMLでは無視します</td>
</tr>
<tr class="odd">
<td>&lt;HEAD&gt;</td>
<td align="center"></td>
<td align="center">○</td>
<td align="center">△</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">属性を指定した場合は無視します</td>
</tr>
<tr class="even">
<td>&lt;TITLE&gt;</td>
<td align="center"></td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">属性を指定した場合は無視します</td>
</tr>
<tr class="odd">
<td>&lt;BASE&gt;</td>
<td align="center"></td>
<td align="center">○</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">HDMLでは無視します</td>
</tr>
<tr class="even">
<td>&lt;BODY&gt;</td>
<td align="center">bgcolor</td>
<td align="center">△</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">HDML、CHTML1.0、CHTML2.0では無視します</td>
</tr>
<tr class="odd">
<td></td>
<td align="center">text</td>
<td align="center">△</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">HDML、CHTML1.0、CHTML2.0では無視します</td>
</tr>
<tr class="even">
<td></td>
<td align="center">link</td>
<td align="center">△</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">HDML、CHTML1.0、CHTML2.0では無視します</td>
</tr>
<tr class="odd">
<td>&lt;A&gt;</td>
<td align="center">href</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="even">
<td></td>
<td align="center">accesskey</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td>&lt;BR&gt;</td>
<td align="center"></td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="even">
<td>&lt;FONT&gt;</td>
<td align="center">color</td>
<td align="center">△</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">HDML,CHTML1.0では無視します</td>
</tr>
<tr class="odd">
<td>&lt;FORM&gt;</td>
<td align="center">action</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="even">
<td></td>
<td align="center">method</td>
<td align="center">○</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">HDMLでは無視します</td>
</tr>
<tr class="odd">
<td>&lt;INPUT&gt;</td>
<td align="center">name</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"><span class="note"><a href="#doc1_862" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="SoftBankの予約クエリ名は内部で変換するので指定しても良い"><sup>(11)</sup></a></span></td>
</tr>
<tr class="even">
<td></td>
<td align="center">type</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">text,password,hidden,radio,checkbox,submitに対応</td>
</tr>
<tr class="odd">
<td></td>
<td align="center">value</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="even">
<td></td>
<td align="center">istyle</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td>&lt;SELECT&gt;</td>
<td align="center">name</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="even">
<td></td>
<td align="center">size</td>
<td align="center">○</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">HDMLでは無視します</td>
</tr>
<tr class="odd">
<td>&lt;OPTION&gt;</td>
<td align="center">value</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"><span class="note"><a href="#doc1_1006" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="必ず閉じてください。そのうち対応します。"><sup>(12)</sup></a></span></td>
</tr>
<tr class="even">
<td></td>
<td align="center">checked</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td>&lt;DIV&gt;</td>
<td align="center">align</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="even">
<td>&lt;HR&gt;</td>
<td align="center"></td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td>&lt;CENTER&gt;</td>
<td align="center"></td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="even">
<td>&lt;IMG&gt;</td>
<td align="center">src</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td>&lt;DL&gt;</td>
<td align="center">　</td>
<td align="center">○</td>
<td align="center">&times;</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"></td>
</tr>
<tr class="even">
<td>&lt;DT&gt;</td>
<td align="center">　</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"><span class="note"><a href="#doc1_1175" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="必ず閉じてください。そのうち対応します。"><sup>(13)</sup></a></span></td>
</tr>
<tr class="odd">
<td>&lt;DD&gt;</td>
<td align="center">　</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left"><span class="note"><a href="#doc1_1200" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="必ず閉じてください。そのうち対応します。"><sup>(14)</sup></a></span></td>
</tr>
<tr class="even">
<td>&lt;CHXJ:IF&gt;</td>
<td align="center">lang</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="center">○</td>
<td align="left">lang=&quot;chtml&quot; lang=&quot;xhtml&quot; lang=&quot;hdml&quot; lang=&quot;jhtml&quot;が指定できます</td>
</tr>
</tbody>
</table>
</div>


<div class="footnote">
<ol>
<li id="doc1_862" value="11"> SoftBankの予約クエリ名は内部で変換するので指定しても良い<li id="doc1_1006" value="12"> 必ず閉じてください。そのうち対応します。<li id="doc1_1175" value="13"> 必ず閉じてください。そのうち対応します。<li id="doc1_1200" value="14"> 必ず閉じてください。そのうち対応します。</ol>
</div>


<h2 id="doc1_1231">独自拡張タグ</h2>


<ol>
<li> <p>&lt;CHXJ:IF&gt;<br></br></p>
<p>&lt;CHXJ:IF&gt;タグと&lt;/CHXJ:IF&gt;タグではさまれたタグやテキストは、変換せずに<b>そのまま</b><span class="note"><a href="#doc1_1241" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="変換しませんので注意が必要です"><sup>(15)</sup></a></span>出力します。必須の属性としてlangがあります。lang属性を指定することによって、例えば、<b>「HDML機の場合のみ出力させる」</b>といったことを可能にします。<br></br><br></br>ex)</p>

<div id="doc1_1251" class="caption">HTML文書中にHDML機の場合のみ有効にしたいタグ、または文書がある場合</div>
<pre class="program" style="margin-top:0">
       &lt;CHXJ:IF lang=&quot;HDML&quot; &gt;
         &lt;NODISPLAY&gt;
&lt;ACTION TYPE=ACCEPT TASK=GOSUB \
    DEST='device:data/dnld?url=abc&amp;name=abc.jpg&amp;size=100&amp;disposition=devjaww&amp;title=test'&gt; \
         &lt;/NODISPLAY&gt;
       &lt;/CHXJ:IF&gt;
       
</pre>

<p><br></br></p>
<p>ex)</p>

<div id="doc1_1255" class="caption">i-Modeのみ出力したい文書がある場合</div>
<pre class="program" style="margin-top:0">
       &lt;CHXJ:IF lang=&quot;chtml&quot; &gt;
         シークレットコードがどーのこーの。
       &lt;/CHXJ:IF&gt;
       
</pre>

<p><br></br></p>
<p>また、lang属性は、複数指定することも可能です。<br></br></p>

<div id="doc1_1261" class="caption">HDML機,J-PHONE機は以下を出力します</div>
<pre class="program" style="margin-top:0">
       &lt;CHXJ:IF lang=&quot;chtml&quot; lang=&quot;jhtml&quot;&gt;
       あなたの携帯は、HDML機かJ-HTML機です。
       &lt;/CHXJ:IF&gt;
       
</pre>

<p><br></br></p></ol>


<div class="footnote">
<ol>
<li id="doc1_1241" value="15"> 変換しませんので注意が必要です</ol>
</div>


<h2 id="doc1_1268">文字コードについて</h2>

<p class="first_ja">サーバサイドコンテンツについてはShift_JIS(CP932)、EUCJP-WIN(Win外字対応のEUCJP)、UTF-8のどれかで記述することが可能です。Shift_JISで記述した場合は絵文字についてもShift_JISで、EUCJP-WINで記述した場合は絵文字についてもEUCJP-WINで、UTF-8で記述した場合は絵文字についてもUTF-8で記述します。<span class="note"><a href="#doc1_1270" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="詳細は「絵文字について」の項を参照のこと"><sup>(16)</sup></a></span>クライアントサイド（端末側）に送信する文字コードはShift_JISまたはUTF-8を指定することが可能です。<span class="note"><a href="#doc1_1273" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="指定方法については「デバイス定義」の項を参照のこと。"><sup>(17)</sup></a></span>mod_chxjによりサーバサイドコンテンツの文字コードから端末に送信する文字コードへと絵文字も含めて変換します。POST/GET中のデータについても端末側文字コードからサーバサイドコンテンツの文字コードへと絵文字も含めて変換します。</p>

<ol>
<li> 注意: Shift_JISでサーバサイドコンテンツを記述した場合はPOST/GETデータもShift_JISでサーバサイドコンテンツに渡されます。
<li> 注意: EUCJP-WINでサーバサイドコンテンツを記述した場合はPOST/GETデータもEUCJP-WINでサーバサイドコンテンツに渡されます。
<li> 注意: UTF-8でサーバサイドコンテンツを記述した場合はPOST/GETデータもUTF-8でサーバサイドコンテンツに渡されます。
<li> 注意:本変換機能は1.0.0以降から</ol>

<p>サーバサイドコンテンツの文字コードはChxjConvRuleディレクティブで指定した文字コードになります。ChxjConvRuleにて矛盾が生じない限り、文字コードの混在も可能です。</p>

<div class="footnote">
<ol>
<li id="doc1_1270" value="16"> 詳細は「絵文字について」の項を参照のこと<li id="doc1_1273" value="17"> 指定方法については「デバイス定義」の項を参照のこと。</ol>
</div>


<h2 id="doc1_1297">絵文字について</h2>

<p class="first_ja">i-Mode用の絵文字を書いておけば、アクセスしたキャリアによって、mod_chxjが対応の絵文字に自動変換します。ソースに2byteのバイナリコードを直接書いても、10進参照文字列(&amp;#XXX;の形)、16進参照文字列(&amp;#xXXX;の形)で書いても、変換対象になります。10進参照文字列、16進参照文字列はmod_chxjにより自動で2バイトコードに変換されます。<span class="note"><a href="#doc1_1299" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="コンテンツをSJISで記述する場合には絵文字もSJISで、コンテンツをEUCJP-WINで記述する場合には絵文字もEUCJP-WINで、UTF-8で記述する場合には絵文字もUTF-8で記述する必要があります"><sup>(18)</sup></a></span></p>

<div class="footnote">
<ol>
<li id="doc1_1299" value="18"> コンテンツをSJISで記述する場合には絵文字もSJISで、コンテンツをEUCJP-WINで記述する場合には絵文字もEUCJP-WINで、UTF-8で記述する場合には絵文字もUTF-8で記述する必要があります</ol>
</div>


<h3 id="doc1_1302">絵文字変換定義</h3>

<p class="first_ja">絵文字の変換に関する動作を変えたい場合（例えば「ハートがあったら、ＡＵの場合はスペードに」とか、「変換定義がおかしい」といった場合）は、emoji.xmlファイルを直接編集することによって定義を変更することが可能です。emoji.xmlはXMLファイルとなっていますので、人によってはvi等で簡単に定義を変更することができるかもしれません。</p>
<p>emoji.xmlは3つのパートに分かれています。1つ目はDoCoMo→DoCoMo/au/SoftBankの変換定義部。2つ目はau→DoCoMoの変換定義部。3つ目はSoftBank→DoCoMoの変換定義部。1つ目はサーバサイドコンテンから各キャリアの絵文字に変換する際に使用されます。2つ目と3つ目はPOST/GETデータの変換に使用されます。</p>
<p><br></br></p>

<h3 id="doc1_1309">DoCoMo→DoCoMo/au/SoftBank変換定義</h3>

<p class="first_ja">以下に、emoji.xmlファイルの1つ目のパート、DoCoMo→DoCoMo/au/SoftBankの変換定義部を記します。</p>

<div id="doc1_1311" class="caption">emoji.xml</div>
<pre class="program" style="margin-top:0">
&lt;emoji&gt;
  &lt;set&gt;
    &lt;no&gt;1&lt;/no&gt;
    &lt;imode&gt;
      &lt;sjis-hex&gt;f89f&lt;/sjis-hex&gt;
      &lt;sjis-dec&gt;63647&lt;/sjis-dec&gt;
      &lt;eucjp-hex&gt;8ffca1&lt;/eucjp-hex&gt;
      &lt;eucjp-dec&gt;9436321&lt;/eucjp-dec&gt;
      &lt;unicode-hex&gt;e63e&lt;/unicode-hex&gt;
      &lt;unicode-dec&gt;58942&lt;/unicode-dec&gt;
      &lt;utf8-hex&gt;ee98be&lt;/utf8-hex&gt;
      &lt;utf8-dec&gt;15636670&lt;/utf-dec&gt;
      &lt;description&gt;晴れ&lt;/description&gt;
    &lt;/imode&gt;
    &lt;ezweb&gt;
      &lt;A&gt;
        &lt;no&gt;44&lt;/no&gt;
        &lt;sjis-hex&gt;f660&lt;/sjis-hex&gt;
        &lt;sjis-dec&gt;63072&lt;/sjis-dec&gt;
        &lt;unicode-hex&gt;e488&lt;/unicode-hex&gt;
        &lt;unicode-dec&gt;58504&lt;/unicode-dec&gt;
        &lt;utf8-hex&gt;eebda0&lt;/utf8-hex&gt;
        &lt;utf8-dec&gt;15646112&lt;/utf-dec&gt;
      &lt;/A&gt;
      &lt;B&gt;
        &lt;no&gt;44&lt;/no&gt;
        &lt;sjis-hex&gt;f660&lt;/sjis-hex&gt;
        &lt;sjis-dec&gt;63072&lt;/sjis-dec&gt;
        &lt;unicode-hex&gt;e488&lt;/unicode-hex&gt;
        &lt;unicode-dec&gt;58504&lt;/unicode-dec&gt;
        &lt;utf8-hex&gt;eebda0&lt;/utf8-hex&gt;
        &lt;utf8-dec&gt;15646112&lt;/utf-dec&gt;
      &lt;/B&gt;
      &lt;C&gt;
        &lt;no&gt;44&lt;/no&gt;
        &lt;sjis-hex&gt;f660&lt;/sjis-hex&gt;
        &lt;sjis-dec&gt;63072&lt;/sjis-dec&gt;
        &lt;unicode-hex&gt;e488&lt;/unicode-hex&gt;
        &lt;unicode-dec&gt;58504&lt;/unicode-dec&gt;
        &lt;utf8-hex&gt;eebda0&lt;/utf8-hex&gt;
        &lt;utf8-dec&gt;15646112&lt;/utf-dec&gt;
      &lt;/C&gt;
      &lt;D&gt;
        &lt;no&gt;44&lt;/no&gt;
        &lt;sjis-hex&gt;f660&lt;/sjis-hex&gt;
        &lt;sjis-dec&gt;63072&lt;/sjis-dec&gt;
        &lt;unicode-hex&gt;e488&lt;/unicode-hex&gt;
        &lt;unicode-dec&gt;58504&lt;/unicode-dec&gt;
        &lt;utf8-hex&gt;eebda0&lt;/utf8-hex&gt;
        &lt;utf8-dec&gt;15646112&lt;/utf-dec&gt;
      &lt;/D&gt;
    &lt;/ezweb&gt;
    &lt;softbank&gt;
      &lt;no&gt;74&lt;/no&gt;
      &lt;sjis-hex&gt;476a&lt;/sjis-hex&gt;
      &lt;sjis-dec&gt;116572776975&lt;/sjis-dec&gt;
      &lt;unicode-hex&gt;e04a&lt;/unicode-hex&gt;
      &lt;unicode-dec&gt;57418&lt;/unicode-dec&gt;
      &lt;utf8-hex&gt;ee818a&lt;/utf8-hex&gt;
      &lt;utf8-dec&gt;15630730&lt;/utf-dec&gt;
    &lt;/softbank&gt;
  &lt;/set&gt;
     ・
     ・
     ・
     ・
&lt;/emoji&gt;
</pre>

<p>絵文字の定義は、&lt;emoji&gt;タグから&lt;/emoji&gt;タグまでの間にあります。その中の要素を説明します。1つの絵文字につき、1つのセット（&lt;set&gt;タグから&lt;/set&gt;タグまで）とし、キャリア毎の絵文字を定義しています。合計176セットあります。</p>

<ol>
<li> &lt;imode&gt;要素<br></br>まず、元となるi-Mode用の絵文字は、&lt;imode&gt;タグにはさまれた間に定義されています。&lt;imode&gt;要素は子にsjis、eucjp、utf8、unicodeのそれぞれ16進と10進表記データを保持します。sjis-hexはShift_JISコードの16進表記、sjis-decはShift_JISコードの10進表記、eucjp-hexはEUCJP-WINの16進表記、eucjp-decはEUCJP-WINの10進表記、utf8-hexはUTF-8の16進表記、utf8-decはUTF-8の10進表記、unicode-hexはUNICODEの16進表記、unicode-decはUNICODEの10進表記となります。サーバサイドコンテンツがSJISで記述されている場合はimode要素のsjis-hex、sjis-decを参照します。同様にがEUCJP-WINで記述されている場合はimode要素のeucjp-hex、eucjp-decを参照します。UTF-8で記述されている場合はimode要素のutf8-hex、utf8-decを参照します。<br></br>サーバサイドコンテンツのマッチするコードがimode要素の中に存在すれば、変換は同一set内のデータを使用して行われます。
<br></br><br></br><li> &lt;ezweb&gt;要素<br></br>アクセスしてきた端末が、AU機であった場合、&lt;ezweb&gt;要素に定義されている値に変換します。&lt;ezweb&gt;要素は、&lt;A&gt;〜&lt;D&gt;要素を持っていて、それぞれAUの絵文字タイプＡ〜Ｄに対応していますので、もし、Ｄタイプの絵文字端末であったなら、&lt;D&gt;要素の&lt;no&gt;に定義されている値に変換します。ここで定義されている値は、HDML機の場合は、<b>&lt;IMG ICON=&quot;XX&quot;&gt;</b>の&quot;XX&quot;の部分に当てはめられて、置換されます。XHTML機の場合は、<b>&lt;IMG LOCALSRC=&quot;XX&quot;&gt;</b>の&quot;XX&quot;の部分に当てはめられて、置換されます。同要素にはsjis-hex、sjis-dec、unicode-hex、unicode-dec、utf8-hex、utf8-decが有りますが、今のところ使用していません。
<br></br><br></br><li> &lt;softbank&gt;要素<br></br>アクセスしてきた端末が、SoftBank/Vodafone/J-Phone端末であった場合、&lt;softbank&gt;要素に定義されている値に変換します。&lt;softbank&gt;要素は、上記要素と同様にsjis-hex、sjis-dec、unicode-hex、unicode-dec、utf8-hex、utf8-decを保持しています。アクセスしてきた端末にはsjisを返す場合はsjis-hex、sjis-decの値を使用します。utf8を返す場合にはutf8-hex、utf8-decでは無くunicode-hex、unicode-decを返します。SoftBank端末の場合は3G端末は基本的にUTF8を返すようにデバイス定義にて定義されています。UTF8で定義された場合でSoftBankの場合はUNICODEの参照文字列を返すようになっています。(問題回避のため)</ol>

<p><br></br>emoji.xmlに定義されていない絵文字で、変換したい絵文字がある場合には、このファイルに新たな定義を足せば、変換するようになります。<span class="note"><a href="#doc1_1349" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="同一コード領域に割り当てる必要があるかもしれません"><sup>(19)</sup></a></span></p>

<div class="footnote">
<ol>
<li id="doc1_1349" value="19"> 同一コード領域に割り当てる必要があるかもしれません</ol>
</div>


<h3 id="doc1_1356">au→DoCoMo変換定義</h3>

<p class="first_ja">au-&gt;DoCoMo変換の定義は主にau端末からサーバサイドへのPOST/GETデータの変換に使用されます。定義はemoji.xmlファイルの&lt;ezweb2imode&gt;タグではさまれたところに定義してあります。&lt;set&gt;から&lt;/set&gt;までの間が1絵文字を表現する部分になります。<br></br>以下に、emoji.xmlファイルの2つ目のパート、au→DoCoMo変換定義を以下に記します。</p>

<div id="doc1_1360" class="caption">emoji.xml</div>
<pre class="program" style="margin-top:0">
&lt;ezweb2imode&gt;
  &lt;set&gt;
    &lt;no&gt;1&lt;/no&gt;
    &lt;ezweb&gt;
      &lt;sjis-hex&gt;F659&lt;/sjis-hex&gt;
      &lt;utf8-hex&gt;eebd99&lt;/utf8-hex&gt;
    &lt;/ezweb&gt;
    &lt;imode&gt;
      &lt;no&gt;220&lt;/no&gt;
    &lt;/imode&gt;
  &lt;/set&gt;
   ・
   ・
   ・
&lt;/ezweb2imode&gt;
</pre>

<p><br></br></p>

<ol>
<li> &lt;no&gt;要素<br></br>auで定義されている絵文字番号を保持します。
<br></br><br></br><li> &lt;ezweb&gt;要素<br></br>&lt;no&gt;で定義された絵文字番号の実際にPOST/GETされてくる値を保持します。sjis-hexは端末がShift_JISの場合のPOST/GETデータ、utf8-hexは端末がUTF-8の場合のPOST/GETデータになっています。POST/GETされたデータはこの要素に記述されたコードとマッチングされ、マッチした場合絵文字を特定します。
<br></br><br></br><li> &lt;imode&gt;要素<br></br>&lt;ezweb&gt;要素でマッチした場合に参照されるEzWeb絵文字に対応するDoCoMo絵文字番号を保持します。mod_chxjによりDoCoMo絵文字に変換する場合に使用されます。
<br></br><br></br></ol>


<h3 id="doc1_1399">SoftBank→DoCoMo変換定義</h3>

<p class="first_ja">SoftBank-&gt;DoCoMo変換の定義は主にSoftBank端末からサーバサイドへのPOST/GETデータの変換に使用されます。定義はemoji.xmlファイルの&lt;softbank2imode&gt;タグではさまれたところに定義してあります。&lt;set&gt;から&lt;/set&gt;までの間が1絵文字を表現する部分になります。<br></br>以下に、emoji.xmlファイルの3つ目のパート、SoftBank→DoCoMo変換定義を以下に記します。</p>

<div id="doc1_1403" class="caption">emoji.xml</div>
<pre class="program" style="margin-top:0">
&lt;softbank2imode&gt;
  &lt;set&gt;
    &lt;no&gt;
      1
    &lt;/no&gt;
    &lt;softbank&gt;
      &lt;webcode&gt;
        4721
      &lt;/webcode&gt;
      &lt;sjis-hex&gt;
        f941
      &lt;/sjis-hex&gt;
      &lt;utf8-hex&gt;
        ee8081
      &lt;/utf8-hex&gt;
    &lt;/softbank&gt;
    &lt;imode&gt;
      &lt;no&gt;
        140
      &lt;/no&gt;
    &lt;/imode&gt;
  &lt;/set&gt;
   ・
   ・
   ・
   ・
&lt;/softbank2imode&gt;
</pre>

<p><br></br></p>

<ol>
<li> &lt;no&gt;要素<br></br>SoftBankで定義されている絵文字番号を保持します。
<br></br><br></br><li> &lt;softbank&gt;要素<br></br>&lt;no&gt;で定義された絵文字番号の実際にPOST/GETされてくる値を保持します。webcodeは端末がShift_JISの場合でウェブコードを送信してくる場合のPOST/GETデータ、sjis-hexは端末がShift_JISの場合のPOST/GETデータ、utf8-hexは端末がUTF-8の場合のPOST/GETデータになっています。POST/GETされたデータはこの要素に記述されたコードとマッチングされ、マッチした場合絵文字を特定します。
<br></br><br></br><li> &lt;imode&gt;要素<br></br>&lt;ezweb&gt;要素でマッチした場合に参照されるSoftBank絵文字に対応するDoCoMo絵文字番号を保持します。mod_chxjによりDoCoMo絵文字に変換する場合に使用されます。
<br></br><br></br></ol>

<p><br></br><br></br></p>

<h2 id="doc1_1450">デバイス定義 device_data.xml</h2>

<p class="first_ja">mod_chxjの動作を決定付ける重要な定義です。変換対象の端末は全て、device_data.xmlファイルに定義される必要があります。定義されていない端末は、mod_chxjとしては、認識することができません。認識できない場合には、変換せずにそのまま出力します。ただし、Perl互換の正規表現によって定義できるため、正規表現の書き方によっては全ての機種に対応させることも可能です。</p>
<p><br></br></p>

<h3 id="doc1_1454">デバイス定義の要素</h3>

<p class="first_ja">まず以下にデバイス定義を記します。</p>

<div id="doc1_1456" class="caption">device_data.xml</div>
<pre class="program" style="margin-top:0">
&lt;devices&gt;
  &lt;user_agent pattern=&quot;^KDDI-([^     ]+) UP.Browser/[^   ]+ .+&quot;&gt;
    &lt;device&gt;
      &lt;device_id&gt;HI21&lt;/device_id&gt;
      &lt;device_name&gt;C3001H&lt;/device_name&gt;
      &lt;html_spec_type&gt;XHTML_MOBILE_1_0&lt;/html_spec_type&gt;
      &lt;width&gt;120&lt;/width&gt;
      &lt;heigh&gt;130&lt;/heigh&gt;
      &lt;gif&gt;true&lt;/gif&gt;
      &lt;jpeg&gt;true&lt;/jpeg&gt;
      &lt;png&gt;true&lt;/png&gt;
      &lt;bmp2&gt;false&lt;/bmp2&gt;
      &lt;bmp4&gt;false&lt;/bmp4&gt;
      &lt;color&gt;4096&lt;/color&gt;
      &lt;emoji_type&gt;C&lt;/emoji_type&gt;
      &lt;wp_width&gt;120&lt;/wp_width&gt;
      &lt;wp_heigh&gt;116&lt;/wp_heigh&gt;
      &lt;cache&gt;9740&lt;/cache&gt;
      &lt;dpi_width&gt;72&lt;/dpi_width&gt;
      &lt;dpi_heigh&gt;72&lt;/dpi_heigh&gt;
      &lt;charset&gt;SJIS&lt;/charset&gt;
    &lt;/device&gt;
    ・
    ・
    ・
  &lt;/user_agent&gt;
  &lt;user_agent&gt;
    ・
    ・
    ・
  &lt;/user_agent&gt;
    ・
    ・
    ・
&lt;/devices&gt;
</pre>

<p>デバイス定義は&lt;devices&gt;タグに囲まれた中に記述します。devicesタグはuser_agentタグを子に持ちます。user_agentはpattern属性を保持し、端末のUser-Agentヘッダとマッチングされます。user_agentタグのpattern属性とマッチした場合には、そのuser_agentタグの子ノードであるdevice要素を1つづつ見に行きます。user_agentタグのpattern属性は正規表現となっていて、$1がデバイス識別IDになるように定義されていますので、$1とdevice_idタグの要素をマッチングします。マッチしたdeviceを該当端末とし、mod_chxjは該当端末用の変換処理を行います。</p>
<p><br></br>以下に各タグについての説明を記します。</p>

<ol>
<li> <b>devicesタグ</b><br></br>全ての要素は一組のdevicesタグに囲まれます。この中に存在する要素がデバイス定義になります。<br></br><br></br>
<li> <b>user_agentタグ</b><br></br>User-Agentのパターンとそのパターンにマッチするdeviceを子ノードに持ちます。<br></br>pattern属性にはUser-AgentとマッチさせるPerl互換の正規表現を指定します<br></br>仮に&quot;KDDI-CA31 UP.Browser/・・・&quot;というUser-Agentを保持する端末からのアクセスがあった場合は、&lt;user_agent pattern=&quot;^KDDI-([^ ]+) UP.Browser/[^ ]+ .+&quot;&gt;にマッチしますが、&lt;user_agent pattern=&quot;^UP.Browser/[^\-]+-([^ ]+) .+&quot; &gt;にはマッチしません。よってmod_chxjは&lt;user_agent pattern=&quot;^KDDI-([^ ]+) UP.Browser/[^ ]+ .+&quot;&gt;の子ノードを処理対象と判断します。<br></br>pattern属性の要素である正規表現には必ず$1で後方参照できるようグルーピングが必要です。$1で後方参照する値は以下に記すdevice_idタグの値と比較されます。device_idとの比較の結果、等しい値であればそのdevice_idを保持するdeviceタグが該当端末として選択されます。<br></br>user_agentタグレベルではマッチしているもののdevice_idが期待する値を持っていない場合は、user_agentタグ中の最後のdeviceが選択されます。<br></br><br></br>
<li> <p><b>deviceタグ</b><br></br>一台の端末を表現します。<br></br>子ノードとして以下を保持します。<br></br></p>

<ol>
<li> device_id
<li> device_name
<li> html_spec_type
<li> width
<li> height
<li> gif
<li> jpeg
<li> png
<li> bmp2
<li> bmp4
<li> color
<li> emoji_type
<li> wp_width
<li> wp_height
<li> cache
<li> dpi_width
<li> dpi_height
<li> charset</ol>

<p><br></br><br></br></p>
<li> <b>device_idタグ</b><br></br>user_agentタグのpattern属性により生成された$1により後方参照される値と比較される値を保持します。通常DoCoMoであればUser-Agentの「機種名」部、auであればUser-Agentの「デバイスID」部、SoftBankであれば、User-Agentの「機種名」部を記述します。
<div id="doc1_1566" class="caption">例</div>
<pre class="program" style="margin-top:0">
      &lt;!-- DoCoMo F905iの場合 --&gt;
      &lt;device_id&gt;F905i&lt;/device_id&gt;

      &lt;!-- au W54Tの場合 --&gt;
      &lt;device_id&gt;TS3E&lt;/device_id&gt;

      &lt;!-- SoftBank 822SHの場合 --&gt;
      &lt;device_id&gt;822SH&lt;/device_id&gt;
    
</pre>
<li> <b>device_nameタグ</b><br></br>mod_chxjでは本値をデバッグログ出力時にのみ使用します、人が見てわかりやすい名前を入力しておきます。device_idと混同しないように注意します。
<div id="doc1_1575" class="caption">au W21CAの例</div>
<pre class="program" style="margin-top:0">
      &lt;device_name&gt;W21CA&lt;/device_name&gt;
    
</pre>
<li> <b>html_spec_typeタグ</b><br></br>端末のサポートするHTMLタイプを指定します。本タグの値によりHTML変換結果が変わります。指定できる値は以下のとおりです。大文字、小文字は区別しません。
<div class="table">
<table id="doc1_1584" class="data" rules="groups">
<caption>対応HTMLタイプ一覧</caption>
<colgroup span="2">
<col>
<col>
</colgroup>
<thead>
<tr class="even">
<td>値</td>
<td>意味</td>
</tr>
</thead>
<tbody>
<tr class="even">
<td>CHTML_1_0</td>
<td>CHTML1.0対応機種の場合記述します。HTML変換結果はCHTML1.0になります。</td>
</tr>
<tr class="odd">
<td>CHTML_2_0</td>
<td>CHTML2.0対応機種の場合記述します。HTML変換結果はCHTML2.0になります。</td>
</tr>
<tr class="even">
<td>CHTML_3_0</td>
<td>CHTML3.0対応機種の場合記述します。HTML変換結果はCHTML3.0になります。</td>
</tr>
<tr class="odd">
<td>CHTML_4_0</td>
<td>CHTML4.0対応機種の場合記述します。HTML変換結果はCHTML4.0になります。(0.9.0時点ではCHTML3.0と同じ)</td>
</tr>
<tr class="even">
<td>CHTML_5_0</td>
<td>CHTML5.0対応機種の場合記述します。HTML変換結果はCHTML5.0になります。(0.9.0時点ではCHTML3.0と同じ)</td>
</tr>
<tr class="odd">
<td>CHTML_6_0</td>
<td>CHTML6.0対応機種の場合記述します。HTML変換結果はCHTML6.0になります。(0.9.0時点ではCHTML3.0と同じ)</td>
</tr>
<tr class="even">
<td>CHTML_7_0</td>
<td>CHTML7.0対応機種の場合記述します。HTML変換結果はCHTML7.0になります。(0.9.0時点ではCHTML3.0と同じ)</td>
</tr>
<tr class="odd">
<td>XHTML_MOBILE_1_0</td>
<td>auのXHTML対応機種の場合に記述します。HTML変換結果はXHTMLになります。</td>
</tr>
<tr class="even">
<td>HDML</td>
<td>auのHDML対応機種の場合に記述します。HTML変換結果はHDMLになります。</td>
</tr>
<tr class="odd">
<td>JHTML</td>
<td>SoftBankの端末の場合に記述します。HTML変換結果はSoftBank用HTMLになります。</td>
</tr>
</tbody>
</table>
</div>
<li> <b>widthタグ</b><br></br>端末の横幅を指定します。
<li> <b>heightタグ</b><br></br>端末の縦幅を指定します。
<li> <b>gifタグ</b><br></br>端末がgif画像を表示することができる場合(サポートしている場合)はtrueを指定します。表示できない(サポートしていない）場合はfalseを指定します。<span class="note"><a href="#doc1_1710" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="大文字、小文字の区別なし"><sup>(20)</sup></a></span>
<li> <b>jpegタグ</b><br></br>端末がjpeg画像を表示することができる場合(サポートしている場合)はtrueを指定します。表示できない(サポートしていない）場合はfalseを指定します。<span class="note"><a href="#doc1_1719" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="大文字、小文字の区別なし"><sup>(21)</sup></a></span>
<li> <b>pngタグ</b><br></br>端末がpng画像を表示することができる場合(サポートしている場合)はtrueを指定します。表示できない(サポートしていない）場合はfalseを指定します。<span class="note"><a href="#doc1_1728" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="大文字、小文字の区別なし"><sup>(22)</sup></a></span>
<li> <b>bmp2タグ</b><br></br>端末がbmp2画像を表示することができる場合(サポートしている場合)はtrueを指定します。表示できない(サポートしていない）場合はfalseを指定します。<span class="note"><a href="#doc1_1737" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="大文字、小文字の区別なし"><sup>(23)</sup></a></span>通常はfalse。
<li> <b>bmp4タグ</b><br></br>端末がbmp4画像を表示することができる場合(サポートしている場合)はtrueを指定します。表示できない(サポートしていない）場合はfalseを指定します。<span class="note"><a href="#doc1_1746" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="大文字、小文字の区別なし"><sup>(24)</sup></a></span>通常はfalse。
<li> <b>colorタグ</b><br></br>端末の表示可能色数。
<li> <p><b>emoji_typeタグ</b><br></br>auの場合に指定します。au以外の場合は指定しても意味はありません。<br></br>設定できる値は以下のとおり。</p>

<div class="table">
<table id="doc1_1763" class="data" rules="groups">
<caption>emoji_typeに設定できる値</caption>
<colgroup span="2">
<col>
<col>
</colgroup>
<thead>
<tr class="even">
<td>値</td>
<td>意味</td>
</tr>
</thead>
<tbody>
<tr class="even">
<td>A</td>
<td>図柄タイプAをサポートしている場合に指定します。</td>
</tr>
<tr class="odd">
<td>B</td>
<td>図柄タイプBをサポートしている場合に指定します。</td>
</tr>
<tr class="even">
<td>C</td>
<td>図柄タイプCをサポートしている場合に指定します。</td>
</tr>
<tr class="odd">
<td>D</td>
<td>図柄タイプDをサポートしている場合に指定します。</td>
</tr>
</tbody>
</table>
</div>

<p><span class="note"><a href="#doc1_1817" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="大文字、小文字の区別なし"><sup>(25)</sup></a></span></p>
<li> <b>wp_widthタグ</b><br></br>壁紙の横幅を指定します。Mode=WPで画像生成する場合、この値が使用されます。
<li> <b>wp_heightタグ</b><br></br>壁紙の縦幅を指定します。Mode=WPで画像生成する場合、この値が使用されます。
<li> <b>cacheタグ</b><br></br>ブラウザのキャッシュサイズを指定します。
<li> <b>dpi_widthタグ</b><br></br>端末の解像度。
<li> <b>dpi_heightタグ</b><br></br>端末の解像度。
<li> <b>charsetタグ(0.9.0にて追加)</b><br></br>端末に送信する文字コードを指定します。指定できる値はSJISかUTF-8のみ。</ol>

<p><br></br></p>

<div class="footnote">
<ol>
<li id="doc1_1710" value="20"> 大文字、小文字の区別なし<li id="doc1_1719" value="21"> 大文字、小文字の区別なし<li id="doc1_1728" value="22"> 大文字、小文字の区別なし<li id="doc1_1737" value="23"> 大文字、小文字の区別なし<li id="doc1_1746" value="24"> 大文字、小文字の区別なし<li id="doc1_1817" value="25"> 大文字、小文字の区別なし</ol>
</div>

<p><br></br></p>

<h2 id="doc1_1864">イメージ画像変換機能</h2>

<p class="first_ja">mod_chxjには、JPEG、GIF、PNG、BMPファイルを置いておくだけで、デバイス定義に従って、それぞれのキャリア対応のフォーマットに変換する機能があります。画像のサイズ（縦Ｘ横）も、端末の画面サイズに合わせて変換します。画像のサイズ（バイト数）については、デバイス定義中のキャッシュサイズを見て、その値よりも小さくなるように<b>努力</b>しますが、元の画像が大きすぎる場合や、複雑な画像の場合には、キャッシュサイズよりも小さくできずに表示できない場合があります。<br></br>それぞれのタグで指定する場合には、ファイル名の拡張子（.jpgや.gif等）をはずした形で指定します。<br></br>本機能には３つのモードが存在します。そのモードを以下に記します。</p>

<h3 id="doc1_1873">サムネイルモード</h3>

<p class="first_ja">端末側画面サイズの約３分の１程度のサイズ（縦Ｘ横）に画像を縮小表示します。</p>

<div id="doc1_1875" class="caption">サムネイルモード 使用例</div>
<pre class="program" style="margin-top:0">
  &lt;IMG SRC=&quot;/img/logo?Mode=Thumbnail&quot;&gt;
  
</pre>


<h3 id="doc1_1879">壁紙モード</h3>

<p class="first_ja">端末側画面のサイズにマッチするサイズに拡大・縮小します。横長の画像の場合には、縦幅を合わせた後に左右をトリミングします。</p>

<div id="doc1_1881" class="caption">壁紙モード 使用例</div>
<pre class="program" style="margin-top:0">
  &lt;IMG SRC=&quot;/img/logo?Mode=WP&quot;&gt;
  
</pre>


<h3 id="doc1_1885">EzGetモード</h3>

<p class="first_ja">壁紙ダウンロードを行いたい場合に使用します。EzGETモードは、壁紙モードで出力される画像サイズと同一サイズの画像が使用されます。</p>

<div id="doc1_1887" class="caption">EzGetモード 使用例</div>
<pre class="program" style="margin-top:0">
  &lt;A HREF=&quot;/img/logo?Mode=EzGet&quot;&gt;
  
</pre>


<h3 id="doc1_1891">その他の機能</h3>

<p class="first_ja">モードの他に、画像サイズ（縦Ｘ横）を直接指定することも可能です。<b>w</b>パラメータ、<b>h</b>パラメータを使用して指定します。</p>

<ol>
<li> wパラメータ<br></br>横幅を指定します。
<li> hパラメータ<br></br>縦幅を指定します。

<div id="doc1_1911" class="caption">w/hパラメータ 使用例</div>
<pre class="program" style="margin-top:0">
  &lt;IMG SRC=&quot;/img/logo?w=100&amp;h=200&quot;&gt;
  
</pre>

<li> User-Agentパラメータ（uaパラメータ）<br></br>User-Agentを指定します。指定した場合は、リクエストヘッダ中のUser-Agentを本パラメータの値で上書きします。このパラメータに&quot;IGN&quot;を指定した場合は、User-Agentを無視します。Thumbnailモード、壁紙モードと併用時は、640x480を元に画像サイズを算出します。</ol>

<p>上記全てのモード、パラメータはＧＥＴリクエストとしてのみ使用できます。</p>

<h2 id="doc1_1922">ＱＲコード出力機能</h2>


<h3 id="doc1_1924">ＱＲコード出力ハンドラの登録</h3>

<p class="first_ja">ＱＲコード出力機能を使用するには、ＱＲコードハンドラを登録します。httpd.confに以下の記述を追加します。</p>

<div id="doc1_1926" class="caption">httpd.conf</div>
<pre class="program" style="margin-top:0">
  AddHandler chxj-qrcode .qrc
</pre>

<p>なお、ハンドラを登録しないでも、出力フィルターを経由させることで、ＱＲコードを出力させることも可能です。（※ＱＲコードの動的出力を参照）</p>

<h3 id="doc1_1930">ＱＲコードソースファイルの設置</h3>

<p class="first_ja">ハンドラを登録したら、その登録した拡張子を持つファイルを用意します。</p>

<div id="doc1_1932" class="caption">例：a.qrc</div>
<pre class="program" style="margin-top:0">
  &lt;?xml version=1.0 ?&gt;
  
  &lt;qrcode&gt;
    &lt;version&gt;13&lt;/version&gt;
    &lt;level&gt;H&lt;/level&gt;
    &lt;mode&gt;8bit&lt;/mode&gt;
    &lt;size&gt;1&lt;/size&gt;
    &lt;data&gt;テストデータです&lt;/data&gt;
  &lt;/qrcode&gt;
</pre>

<p>.qrcファイルは、qrcode要素、version要素、level要素、mode要素、size要素、data要素から成り立ちます。</p>

<ol>
<li> versionタグversionタグは出力するＱＲコードの生成に利用するバージョンを指定します。使用できるバージョンは、１〜４０までの４０種類です。
<li> levelタグlevelタグは出力するＱＲコードの生成に利用する誤り検出レベルを指定します。　使用できるレベルは、L、Ｑ、Ｍ、Ｈの４つです。
<li> modeタグmodeタグは出力するＱＲコードの生成に利用するモードを指定します。使用できるモードは、NUM（数字モード）ALPHA（英数字モード）8BIT（８ビットバイトモード）KANJI（漢字モード）です。
<li> sizeタグsizeタグは１モジュールを何ピクセルであらわすかを指定します。０を指定した場合は、４を指定した場合と同じ動作をします。　使用できるサイズは、０〜２０までです。
<li> dataタグdataタグは、ＱＲコードに出力するデータを指定します。改行した場合は、改行文字もＱＲコード内に符号化されます。</ol>


<h3 id="doc1_1954">ＱＲコードの動的出力機能</h3>

<p class="first_ja">プログラム等を使用し、動的にＱＲコードを出力したい場合は、上記の.qrcファイルの内容をそのままOutputFilterに通してあげればＯＫです。つまり、ChxjConvertRuleディレクティブで&quot;EngineOn&quot;と指定したURIが指すディレクトリに設置すれば良いということです。mod_chxj内部で、Content-Typeがtext/xmlの場合、QRCode用のファイルであるかどうかを一度読み込んで判断するので、Content-Typeには、text/xmlを設定してください。</p>

<div id="doc1_1956" class="caption">phpでＱＲコードを動的に出力する例</div>
<pre class="program" style="margin-top:0">
    &lt;php
      $version = $_POST[&quot;version&quot;];
      $level   = $_POST[&quot;level&quot;];
      $mode    = $_POST[&quot;mode&quot;];
      $size    = $_POST[&quot;size&quot;];
      $data    = $_POST[&quot;data&quot;];

      header(&quot;Content-Type: text/xml; charset=Shift_JIS&quot;);

      echo &quot;&lt;qrcode&gt;\n&quot;;
      echo &quot;&lt;version&gt;&quot;.$version.&quot;&lt;/version&gt;\n&quot;;
      echo &quot;&lt;level&gt;&quot;.$level.&quot;&lt;/level&gt;\n&quot;;
      echo &quot;&lt;mode&gt;&quot;.$mode.&quot;&lt;/mode&gt;\n&quot;;
      echo &quot;&lt;size&gt;&quot;.$size.&quot;&lt;/size&gt;\n&quot;;
      echo &quot;&lt;data&gt;&quot;.$data.&quot;&lt;/data&gt;\n&quot;;
      echo &quot;&lt;/qrcode&gt;\n&quot;;
    &gt;
  
</pre>

<p>そして、上記のコードを、mod_chxj変換エンジンが処理するはずであるところに設置すれば完了です。</p>

<h2 id="doc1_1961">Cookieシミュレート機能(EXPERIMENTAL)</h2>


<h3 id="doc1_1963">Cookieシミュレート機能(EXPERIMENTAL)</h3>

<p class="first_ja">Cookieを受け付けない（無視する）端末のためにCookieをシミュレートします。本機能を有効にするためにはChxjConvertRuleディレクティブを使用する必要があります。ChxjConvertRuleディレクティブの第２パラメータにCookieOnを指定します。</p>

<div id="doc1_1965" class="caption">Cookieシミュレート機能を有効にする例</div>
<pre class="program" style="margin-top:0">
    ChxjConvertRule &quot;^/chxj.+$&quot; &quot;EngineOn,CookieOn&quot; &quot;NONE&quot;
  
</pre>


<h3 id="doc1_1969">One-Time ID</h3>

<p class="first_ja">Cookieシミュレートでは、aタグ、imgタグ、formタグのURL部にOne-Time IDを埋め込むことで実現します。そのため、ユーザがブラウザの戻るボタン等で戻った場合はCookieを取得できなくなります。</p>

<h3 id="doc1_1972">Cookieの保存場所</h3>

<p class="first_ja">Cookieの内容はサーバ側に保存されます。デフォルトではDBMを使用し、保存ディレクトリはChxjCookieDirディレクティブを使用することで指定することができます。指定しなかった場合は、/tmpに保存されます。</p>

<div id="doc1_1974" class="caption">ChxjCookieDirの例</div>
<pre class="program" style="margin-top:0">
    ChxjCookieDir /var/abc
  
</pre>

<p>DBMの代わりにMySQLを指定することもできます。その際は、ChxjCookieDirは指定する必要はありません。MySQLを使用するには、configure時にMySQL COOKIE機能を有効にして、コンパイルする必要があります。<span class="note"><a href="#doc1_1977" onmouseover="hilightSelflink(this)" onmouseout="normal(this)" title="Buildの項参照"><sup>(26)</sup></a></span>また以下のディレクティブを指定する必要もあります。</p>

<ol>
<li> ChxjCookieMysqlHost<br></br> MySQLサーバの動作するホストを指定します。
<div id="doc1_1986" class="caption">ChxjCookieMysqlHostの例</div>
<pre class="program" style="margin-top:0">
         ChxjCookieMysqlHost &quot;localhost&quot;
      
</pre>
<li> ChxjCookieMysqlPort<br></br> MySQLサーバのポート番号を指定します。
<div id="doc1_1994" class="caption">ChxjCookieMysqlPortの例</div>
<pre class="program" style="margin-top:0">
         ChxjCookieMysqlPort 3306
      
</pre>
<li> ChxjCookieMysqlDatabase<br></br> MySQLサーバのデータベース名を指定します。
<div id="doc1_2002" class="caption">ChxjCookieMysqlDatabaseの例</div>
<pre class="program" style="margin-top:0">
         ChxjCookieMysqlDatabase &quot;test_db&quot;
      
</pre>
<li> ChxjCookieMysqlUsername<br></br> MySQLサーバに接続する際に使用するユーザ名を指定します。
<div id="doc1_2010" class="caption">ChxjCookieMysqlUsernameの例</div>
<pre class="program" style="margin-top:0">
         ChxjCookieMysqlUsername &quot;roottest&quot;
      
</pre>
<li> ChxjCookieMysqlPassword<br></br> MySQLサーバに接続する際に使用するパスワードを指定します。
<div id="doc1_2018" class="caption">ChxjCookieMysqlPasswordの例</div>
<pre class="program" style="margin-top:0">
         ChxjCookieMysqlPassword &quot;pwtest&quot;
      
</pre>
<li> ChxjCookieMysqlSocketPath<br></br> MySQLのソケットパスを指定します。
<div id="doc1_2026" class="caption">ChxjCookieMysqlSocketPathの例</div>
<pre class="program" style="margin-top:0">
         ChxjCookieMysqlSocketPath  &quot;/tmp/mysql.sock&quot;
      
</pre>
<li> ChxjCookieMysqlCharset<br></br> MySQLのエンコードを指定します。
<div id="doc1_2034" class="caption">ChxjCookieMysqlCharsetの例</div>
<pre class="program" style="margin-top:0">
         ChxjCookieMysqlCharset  &quot;utf8&quot;
      
</pre>
<li> <p>ChxjCookieMysqlTablename<br></br> MySQLのクッキーを保存するテーブル名を指定します。</p>

<div id="doc1_2042" class="caption">ChxjCookieMysqlTablenameの例</div>
<pre class="program" style="margin-top:0">
         ChxjCookieMysqlTablename  &quot;chxj_cookie&quot;
      
</pre>

<p>上記のように&quot;chxj_cookie&quot;と指定すると、実際に作成されるテーブルは、chxj_cookieとchxj_cookie_expireテーブルの2つになります。</p></ol>


<div class="footnote">
<ol>
<li id="doc1_1977" value="26"> Buildの項参照</ol>
</div>


<h3 id="doc1_2048">Cookieの保持期間</h3>

<p class="first_ja">ChxjCookieTimeoutディレクティブで保持期間を指定することができます。指定しなかった場合は1800秒でサーバに保存されているCookieは削除されます。</p>

<div id="doc1_2050" class="caption">ChxjCookieTimeoutの例</div>
<pre class="program" style="margin-top:0">
    &lt;Location /&gt;
      ChxjCookieTimeout 10
    &lt;/Location&gt;
  
</pre>

<p>上記の例は、10秒でタイムアウト(サーバから削除)するように指定しています。</p>

<h2 id="doc1_2055">Refererシミュレート機能(EXPERIMENTAL)</h2>


<h3 id="doc1_2057">Refererシミュレート機能(EXPERIMENTAL)</h3>

<p class="first_ja">DoCoMo端末などのRefererに対応していない機種のためにRefererシミュレート機能を提供します。本機能は、Cookieシミュレート機能を有効にすると、自動で有効になります(将来的には変更予定)。</p>
</body>
</html>
